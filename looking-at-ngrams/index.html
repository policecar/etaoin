<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>n-gram viewer</title>
		<!-- <script type="text/javascript" src="./d3.v3.min.js" charset="utf-8"></script> -->
		<script type="text/javascript" src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
		<script type="text/javascript" src="./p.js" charset="utf-8"></script>
	</head>
	<body>
		<script type="text/javascript" charset="utf-8">
			// test if this browser provides full support of the File API
			if ( window.File && window.FileReader && window.FileList && window.Blob ) {
				// Great success! All the File APIs are supported.
			} else {
				alert( "The File APIs are not fully supported in this browser." );
			}
		</script>
		
		<!-- a file selector -->
		<input type="file" id="files" name="files[]" multiple /> <!-- accept="text/*" -->
		<output id="output"></output>

		<script type="text/javascript" charset="utf-8">
			// handle on change events of the File selector
			function handleFileSelect( evt ) {
			
				var files = evt.target.files; // FileList object

				// files is a FileList of File objects. List some properties.
				var output = [];
				for ( var i = 0, f; f = files[i]; i++ ) {
					output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
						f.size, ' bytes, last modified: ',
						f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a', '</li>');
				}
				document.getElementById( 'output' ).innerHTML = '<ul>' + output.join('') + '</ul>';

				for ( var i = 0, f; f = files[i]; i++ ) {

					var reader = new FileReader();

					reader.onload = (function( theFile ) {
						return function(e) {
							var data = p.processFileContent( e.target.result );
							p.makeGraph( data );
						};
					})(f);
					reader.readAsText( f, "UTF-8" ); // utf-8 is the default but to be most explicit
				}
			}
			document.getElementById( 'files' ).addEventListener( 'change', handleFileSelect, false );
		</script>
	</body>
</html>